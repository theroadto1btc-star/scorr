<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Live Wedstrijden - SCORR Kantine Display</title>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@300;400;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --green: #00FF88;
            --dark: #0A0E27;
            --dark2: #1E2749;
            --red: #FF3B5C;
            --yellow: #FFD600;
            --white: #F0F4FF;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Lexend', sans-serif;
            background: var(--dark);
            min-height: 100vh;
            color: var(--white);
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image:
                linear-gradient(rgba(0,255,136,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,255,136,0.03) 1px, transparent 1px);
            background-size: 48px 48px;
            pointer-events: none;
            z-index: 0;
        }

        /* ===== HEADER ===== */
        .header {
            position: relative;
            z-index: 1;
            background: linear-gradient(135deg, var(--dark) 0%, var(--dark2) 100%);
            border-bottom: 2px solid rgba(0,255,136,0.4);
            padding: 24px 40px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -1px; left: 0; right: 0;
            height: 1px;
            background: linear-gradient(90deg, transparent, var(--green), transparent);
        }

        .header-left { display: flex; align-items: center; gap: 20px; }

        .club-logo {
            width: 64px; height: 64px;
            background: rgba(255,255,255,0.08);
            border: 2px solid rgba(0,255,136,0.3);
            border-radius: 50%;
            display: flex; align-items: center; justify-content: center;
            font-size: 28px; flex-shrink: 0;
        }

        .club-name { font-size: 28px; font-weight: 700; color: var(--white); line-height: 1.1; }
        .header-subtitle { font-size: 11px; color: var(--green); font-weight: 600; text-transform: uppercase; letter-spacing: 3px; margin-top: 4px; }

        /* PILOT badge - centered, green */
        .pilot-badge {
            font-size: 13px;
            font-weight: 900;
            letter-spacing: 4px;
            text-transform: uppercase;
            color: var(--green);
            border: 2px solid rgba(0,255,136,0.5);
            padding: 6px 20px;
            border-radius: 20px;
            text-shadow: 0 0 16px rgba(0,255,136,0.4);
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
        }

        .scorr-logo {
            font-size: 52px; font-weight: 900; letter-spacing: -3px;
            color: var(--green); text-shadow: 0 0 40px rgba(0,255,136,0.3);
            line-height: 1; flex-shrink: 0;
        }

        /* ===== LIVE TICKER ===== */
        .live-ticker {
            position: relative; z-index: 1;
            background: rgba(0,255,136,0.06);
            border-bottom: 1px solid rgba(0,255,136,0.15);
            padding: 10px 40px;
            display: flex; align-items: center; gap: 16px;
        }

        .live-pill {
            display: flex; align-items: center; gap: 6px;
            background: var(--red); color: white;
            padding: 4px 12px; border-radius: 20px;
            font-size: 10px; font-weight: 700; letter-spacing: 2px;
            text-transform: uppercase; flex-shrink: 0;
        }

        .live-dot { width: 6px; height: 6px; background: white; border-radius: 50%; animation: blink 1.5s infinite; }

        @keyframes blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.2; } }

        .ticker-text { font-size: 12px; color: rgba(240,244,255,0.5); font-weight: 300; letter-spacing: 1px; }
        .ticker-update { margin-left: auto; font-size: 11px; color: rgba(240,244,255,0.3); }

        /* ===== CONTAINER ===== */
        .container { position: relative; z-index: 1; max-width: 1400px; margin: 0 auto; padding: 32px 40px; }

        .section-header {
            display: flex; align-items: center; gap: 12px;
            margin-bottom: 20px; padding-bottom: 16px;
            border-bottom: 1px solid rgba(255,255,255,0.06);
        }

        .section-icon { font-size: 24px; }
        .section-title { font-size: 18px; font-weight: 700; color: var(--white); flex: 1; }
        .match-count { font-size: 12px; color: rgba(240,244,255,0.4); background: rgba(255,255,255,0.06); padding: 4px 12px; border-radius: 20px; font-weight: 600; }

        /* ===== MATCH CARD ===== */
        .match-card {
            background: rgba(30,39,73,0.6);
            border: 1px solid rgba(255,255,255,0.07);
            border-radius: 16px; padding: 20px 28px;
            margin-bottom: 12px;
            display: flex; align-items: center; gap: 20px;
            transition: all 0.3s ease;
        }

        .match-card.live {
            border-color: rgba(0,255,136,0.3);
            background: linear-gradient(135deg, rgba(30,39,73,0.8) 0%, rgba(0,255,136,0.04) 100%);
            box-shadow: 0 0 24px rgba(0,255,136,0.06);
        }

        .match-card.afgelopen { opacity: 0.7; }

        /* Status */
        .match-status { display: flex; flex-direction: column; align-items: center; min-width: 88px; gap: 6px; }

        .match-time { font-size: 26px; font-weight: 700; color: var(--white); line-height: 1; }
        .match-time.live { color: var(--green); animation: glow 2s ease-in-out infinite; }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 8px rgba(0,255,136,0.4); }
            50% { text-shadow: 0 0 20px rgba(0,255,136,0.8); }
        }

        .status-badge { font-size: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 1px; padding: 3px 10px; border-radius: 10px; }
        .status-badge.live { background: var(--green); color: var(--dark); }
        .status-badge.straks { background: var(--yellow); color: var(--dark); }
        .status-badge.morgen { background: var(--yellow); color: var(--dark); }
        .status-badge.afgelopen { background: var(--red); color: white; }

        .card-divider { width: 1px; height: 48px; background: rgba(255,255,255,0.08); flex-shrink: 0; }

        /* Teams */
        .teams-row { flex: 1; display: flex; align-items: center; gap: 16px; }

        .team { flex: 1; display: flex; align-items: center; gap: 14px; min-width: 0; }
        .team.away { flex-direction: row-reverse; }

        /* Logo - geen zwarte rand */
.team-logo img {
    width: 85%;
    height: 85%;
    object-fit: contain;
    mix-blend-mode: multiply;
}

        .team-logo img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    padding: 3px;
    mix-blend-mode: multiply;
}

        .team-logo.initials {
            background: #003399;
            font-size: 13px;
        }

        .team-logo.initials.away { background: #1E2749; }

        .team-name { font-size: 18px; font-weight: 600; color: var(--white); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .team.away .team-name { text-align: right; }

        /* Score */
        .score-block { display: flex; align-items: center; gap: 8px; padding: 0 16px; flex-shrink: 0; }
        .score { font-size: 44px; font-weight: 900; color: var(--white); min-width: 48px; text-align: center; line-height: 1; }
        .match-card.live .score { color: var(--green); }
        .score-sep { font-size: 28px; font-weight: 300; color: rgba(240,244,255,0.2); }

        /* Veld */
        .veld-badge { font-size: 11px; color: rgba(240,244,255,0.3); background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.08); border-radius: 6px; padding: 2px 8px; font-weight: 600; flex-shrink: 0; }

        /* Empty */
        .empty-state { text-align: center; padding: 80px 40px; color: rgba(240,244,255,0.2); }
        .empty-icon { font-size: 64px; margin-bottom: 16px; }
        .empty-title { font-size: 20px; font-weight: 700; margin-bottom: 8px; }
        .empty-sub { font-size: 14px; font-weight: 300; }

        /* Footer */
        .footer {
            position: relative; z-index: 1;
            padding: 24px 40px; color: rgba(255,255,255,0.2); font-size: 12px;
            border-top: 1px solid rgba(255,255,255,0.05);
            display: flex; align-items: center; justify-content: space-between;
        }

        .footer-scorr { font-size: 20px; font-weight: 900; color: rgba(0,255,136,0.4); letter-spacing: -1px; }
        .auto-refresh { display: flex; align-items: center; gap: 8px; }
        .refresh-dot { width: 6px; height: 6px; background: var(--green); border-radius: 50%; animation: blink 2s infinite; }

        /* Responsive */
        @media (max-width: 768px) {
            .header { padding: 16px; flex-wrap: wrap; gap: 10px; }
            .pilot-badge { position: static; transform: none; font-size: 10px; padding: 4px 12px; }
            .club-name { font-size: 20px; }
            .scorr-logo { font-size: 32px; }
            .club-logo { width: 44px; height: 44px; font-size: 20px; }
            .live-ticker { padding: 8px 16px; }
            .ticker-update { display: none; }
            .container { padding: 12px 16px; }
            .match-card { padding: 14px 16px; gap: 10px; }
            .match-status { flex-direction: column; align-items: center; min-width: 64px; gap: 4px; }
            .match-time { font-size: 18px; }
            .card-divider { display: none; }
            .teams-row { flex-direction: column; gap: 6px; flex: 1; }
            .team, .team.away { flex-direction: row; justify-content: flex-start; width: 100%; gap: 8px; }
            .team.away .team-name { text-align: left; }
            .team-name { font-size: 14px; }
            .team-logo { width: 32px; height: 32px; }
            .score-block { justify-content: center; padding: 4px 0; gap: 4px; }
            .score { font-size: 28px; min-width: 32px; }
            .score-sep { font-size: 20px; }
            .veld-badge { display: none; }
            .footer { flex-direction: column; gap: 6px; padding: 12px 16px; font-size: 11px; }
        }

        @media (max-width: 480px) {
            .club-name { font-size: 17px; }
            .scorr-logo { font-size: 26px; }
            .section-title { font-size: 14px; }
            .team-name { font-size: 13px; }
            .score { font-size: 24px; }
        }
    </style>
</head>
<body>

    <div class="header">
        <div class="header-left">
            <div class="club-logo">‚öΩ</div>
            <div>
                <div class="club-name">Fc Purmerend</div>
                <div class="header-subtitle">Live Wedstrijden</div>
            </div>
        </div>
        <div class="pilot-badge">PILOT</div>
        <div class="scorr-logo">SCORR</div>
    </div>

    <div class="live-ticker">
        <div class="live-pill"><div class="live-dot"></div>Live</div>
        <div class="ticker-text">Scores worden automatisch bijgewerkt</div>
        <div class="ticker-update">Laatste update: <span id="lastUpdate">‚Äî</span></div>
    </div>

    <div class="container">
        <div class="section-header">
            <div class="section-icon">‚öΩ</div>
            <div class="section-title">Fc Purmerend ‚Äî Komende 48 uur</div>
            <div class="match-count" id="matchCount">laden...</div>
        </div>
        <div id="wedstrijden-list">
            <div class="empty-state">
                <div class="empty-icon">‚è≥</div>
                <div class="empty-title">Wedstrijden laden...</div>
            </div>
        </div>
    </div>

    <div class="footer">
        <div class="footer-scorr">SCORR</div>
        <div>Laatste update: <span id="footerUpdate">‚Äî</span></div>
        <div class="auto-refresh"><div class="refresh-dot"></div><span>Updates elke 10 seconden</span></div>
    </div>

    <script>
        var DB_URL = 'https://scorr-c604a-default-rtdb.europe-west1.firebasedatabase.app/wedstrijden.json';

        function getLogo(naam) {
            if (!naam) return null;
            naam = naam.toLowerCase();
            if (naam.indexOf('purmerend') !== -1) return '/frontend/assets/logos/logo_fcpurmerend_nieuw.png';
            if (naam.indexOf('monnickendam') !== -1) return '/frontend/assets/logos/logo-512-512.png';
            if (naam.indexOf('graveland') !== -1 || naam.indexOf('gaveland') !== -1) return '/frontend/assets/logos/images-3.png';
            return null;
        }

        function getInitials(naam) {
            if (!naam) return '?';
            return naam.split(' ').map(function(w) { return w[0]; }).join('').substring(0, 3).toUpperCase();
        }

        function getMinuut(w) {
            if (!w.startTijd) return null;
            var nu = Date.now();
            var verstreken = Math.floor((nu - w.startTijd) / 60000);
            var helfttijd = w.helfttijd || 45;
            if (w.status === 'bezig') {
                return Math.min(verstreken + 1, helfttijd) + "'";
            }
            return null;
        }

        function updateTimestamp() {
            var now = new Date();
            var str = now.toLocaleDateString('nl-NL', { day: 'numeric', month: 'short', hour: '2-digit', minute: '2-digit' });
            document.getElementById('lastUpdate').textContent = str;
            document.getElementById('footerUpdate').textContent = str;
        }

        function renderWedstrijden(wedstrijden) {
            var list = document.getElementById('wedstrijden-list');
            var count = wedstrijden.length;
            document.getElementById('matchCount').textContent = count + ' wedstrijd' + (count !== 1 ? 'en' : '');

            if (count === 0) {
                list.innerHTML = '<div class="empty-state"><div class="empty-icon">üìÖ</div><div class="empty-title">Geen wedstrijden gepland</div><div class="empty-sub">Er staan geen wedstrijden in de komende 48 uur</div></div>';
                updateTimestamp();
                return;
            }

            wedstrijden.sort(function(a, b) {
                if (a.status === 'bezig' && b.status !== 'bezig') return -1;
                if (b.status === 'bezig' && a.status !== 'bezig') return 1;
                return (a.tijdstip || '').localeCompare(b.tijdstip || '');
            });

            var vandaagStr = new Date().toISOString().split('T')[0];
            var html = '';

            for (var i = 0; i < wedstrijden.length; i++) {
                var w = wedstrijden[i];
                var isLive = w.status === 'bezig';
                var isAfgelopen = w.status === 'afgelopen';
                var isRust = w.status === 'rust';

                var isVandaag = w.datum === vandaagStr;
                var badgeClass = (isLive || isRust) ? 'live' : isAfgelopen ? 'afgelopen' : isVandaag ? 'straks' : 'morgen';
                var badgeText = isLive ? 'LIVE' : isRust ? 'HT' : isAfgelopen ? 'FT' : isVandaag ? 'Vandaag' : 'Morgen';

                // Tijd display: minuut als live, anders tijdstip
                var minutStr = getMinuut(w);
                var tijdText = isLive && minutStr ? minutStr : isAfgelopen ? 'AFG' : (w.tijdstip || '‚Äî');

                var datumStr = '';
                if (w.datum) {
                    var d = new Date(w.datum + 'T00:00:00');
                    datumStr = d.toLocaleDateString('nl-NL', {weekday:'short', day:'numeric', month:'short'});
                }  

                var thuisLogo = getLogo(w.thuisteam);
                var uitLogo = getLogo(w.uitteam);

                var thuisLogoHtml = thuisLogo
                    ? '<div class="team-logo"><img src="' + thuisLogo + '" onerror="this.parentNode.className=\'team-logo initials\';this.parentNode.innerHTML=\'' + getInitials(w.thuisteam) + '\'"></div>'
                    : '<div class="team-logo initials">' + getInitials(w.thuisteam) + '</div>';

                var uitLogoHtml = uitLogo
                    ? '<div class="team-logo"><img src="' + uitLogo + '" onerror="this.parentNode.className=\'team-logo initials away\';this.parentNode.innerHTML=\'' + getInitials(w.uitteam) + '\'"></div>'
                    : '<div class="team-logo initials away">' + getInitials(w.uitteam) + '</div>';

                var scoreHtml = (isLive || isAfgelopen || isRust)
                    ? '<div class="score">' + (w.thuisscore || 0) + '</div><div class="score-sep">‚Äî</div><div class="score">' + (w.uitscore || 0) + '</div>'
                    : '<div class="score" style="color:rgba(240,244,255,0.3)">-</div><div class="score-sep">‚Äî</div><div class="score" style="color:rgba(240,244,255,0.3)">-</div>';

                var veldBadge = (w.veld && w.veld !== 'n.v.t.') ? '<div class="veld-badge">Veld ' + w.veld + '</div>' : '';

                html += '<div class="match-card ' + ((isLive || isRust) ? 'live' : '') + ' ' + (isAfgelopen ? 'afgelopen' : '') + '">';
                html += '<div class="match-status">';
                html += '<div class="match-time ' + (isLive ? 'live' : '') + '">' + tijdText + '</div>';
                html += '<div class="status-badge ' + badgeClass + '">' + badgeText + '</div>';
                html += '<div style="font-size:11px;color:rgba(240,244,255,0.35);margin-top:4px;text-align:center;">' + datumStr + '</div>';
                html += '</div>';
                html += '<div class="card-divider"></div>';
                html += '<div class="teams-row">';
                html += '<div class="team home">' + thuisLogoHtml + '<div class="team-name">' + (w.thuisteam || 'Thuis') + '</div></div>';
                html += '<div class="score-block">' + scoreHtml + '</div>';
                html += '<div class="team away">' + uitLogoHtml + '<div class="team-name">' + (w.uitteam || 'Uit') + '</div></div>';
                html += '</div>';
                html += veldBadge;
                html += '</div>';
            }

            list.innerHTML = html;
            updateTimestamp();
        }

        function fetchWedstrijden() {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', DB_URL, true);
            xhr.onreadystatechange = function() {
                if (xhr.readyState === 4 && xhr.status === 200) {
                    try {
                        var data = JSON.parse(xhr.responseText);
                        var wedstrijden = [];
                        var nu = new Date();
                        if (data) {
                            for (var key in data) {
                                if (data.hasOwnProperty(key)) {
                                    var w = data[key];
                                    if (w && w.datum) {
                                        var wedstrijdDatum = new Date(w.datum + 'T00:00:00');
var verschilUren = (wedstrijdDatum - nu) / (1000 * 60 * 60);
var tijdstipUren = w.tijdstip ? parseInt(w.tijdstip.split(':')[0]) : 12;
var eindTijd = new Date(w.datum + 'T' + (w.tijdstip || '12:00') + ':00');
var urenNaEinde = (nu - eindTijd) / (1000 * 60 * 60);
if (verschilUren <= 48 && urenNaEinde <= 24) {
                                            wedstrijden.push(w);
                                        }
                                    }
                                }
                            }
                        }
                        renderWedstrijden(wedstrijden);
                    } catch(e) {
                        console.log('Parse error:', e);
                    }
                }
            };
            xhr.send();
        }

        fetchWedstrijden();
        setInterval(fetchWedstrijden, 10000);
    </script>
</body>
</html>